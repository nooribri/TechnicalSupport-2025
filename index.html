
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {font-family: "Tajawal", sans-serif; background-color:#f4f6f9; color:#222; margin:0; padding:15px;}
    .container {max-width:700px; background:#fff; margin:auto; padding:20px; border-radius:15px; box-shadow:0 2px 8px rgba(0,0,0,0.1);}
    .header {text-align:center;}
    .header img {width:100px; display:block; margin:auto;}
    .header h1 {margin:5px 0; font-size:20px; color:#004085;}
    .header h2 {margin:0; font-size:16px; color:#0069d9;}
    .section-title {margin-top:25px; background:#e9ecef; padding:8px; border-radius:6px; font-weight:600; color:#004085;}
    label {display:block; font-weight:600; margin-bottom:5px;}
    input[type="text"], input[type="date"], textarea, select {width:100%; padding:8px; border:1px solid #ccc; border-radius:8px; font-size:14px; resize:vertical;}
    .radio-group label {display:block; margin:5px 0; font-weight:normal;}
    button {display:block; width:100%; padding:10px; background:#0069d9; color:white; border:none; border-radius:8px; margin-top:20px; font-size:16px; cursor:pointer;}
    button:hover {background:#0056b3;}
    .success-message {display:none; background:#d4edda; color:#155724; border:1px solid #c3e6cb; padding:15px; border-radius:8px; text-align:center; margin-top:20px; font-weight:600;}
    footer {text-align:center; font-size:13px; color:#555; margin-top:40px;}
    .export-buttons {display:flex; gap:10px; margin-top:15px;}
    .export-buttons button {flex:1; background:#28a745;}
    .export-buttons button:hover {background:#218838;}

    .section-title {
  font-weight: bold;
  margin-top: 20px;
  margin-bottom: 10px;
  text-align: center; /* ØªØ¬Ø¹Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙÙŠ Ø§Ù„ÙˆØ³Ø· */
  font-size: 16px; /* Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ø­Ø³Ø¨ Ø§Ù„Ø±ØºØ¨Ø© */
}
/* Ø¥Ø®ÙØ§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆØ§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
@media print {
  .export-buttons, /* div Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
  button {          /* ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    display: none !important;
  }
}
 /* Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
@media print {
  #sendReportButton {
    display: none !important;
  }
}
/* Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
@media print {
  /* Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ input Ù…Ù† Ù†ÙˆØ¹ file */
  input[type="file"] {
    display: none !important;
  }

}
@media print {
  /* Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± */
  #sendSection,
  #sendSectionFields,
  #sendReportButton {
    display: none !important;
  }

  /* Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ input Ù…Ù† Ù†ÙˆØ¹ file */
  input[type="file"] {
    display: none !important;
  }
}

.actions-footer {
  margin-top: 20px;
  text-align: center;
}

.form-meta {
  margin-top: 15px;
  font-size: 13px;
  color: #555;
  text-align: right;
}
.section-title.it-section {
  background-color: #e3f2fd;   /* Ø®Ù„ÙÙŠØ© Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ */
  color: #0d47a1;              /* Ù†Øµ Ø£Ø²Ø±Ù‚ ØºØ§Ù…Ù‚ */
  border-right: 4px solid #0d47a1; /* Ø®Ø· Ø¬Ø§Ù†Ø¨ÙŠ ÙŠÙ…ÙŠÙ† (Ù„Ø£Ù† Ø§Ù„ØµÙØ­Ø© Ø¹Ø±Ø¨ÙŠØ©) */
  padding: 8px 12px;
  border-radius: 6px;
}

.section-title.it-section {
  background-color: #e3f2fd;
  color: #0d47a1;
  border-right: 4px solid #0d47a1;
  padding: 8px 12px;
  border-radius: 6px;
  margin-top: 20px;
}


  </style>
</head>
<body>
 <div class="container">
   <div class="header" style="text-align:center;">
     <img src="image1.png" alt="Ø´Ø¹Ø§Ø± Ø³Ù„Ø·Ù†Ø© Ø¹Ù…Ø§Ù†" class="logo" style="width:100px; display:block; margin:auto;"> 
     <h4 style="margin:0; font-size:18px; color:#556B2F;">Ù‡ÙŠØ¦Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ</h4> 
     <h6 style="margin:0; font-size:16px; color:#556B2F;">Consumer Protection Authority</h6>
      <p style="margin:0; font-size:14px; color:#556B2F;">www.cpa.gov.om</p>
       <p style="margin:0; font-size:14px; color:#556B2F;">Ø¥Ø¯Ø§Ø±Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ Ø¨Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©</p>
     </div>

     <div style="text-align:center; margin:40px 0 20px 0;"> 
      <h5 style="margin:5px 0; font-weight:600;">Ø¥Ø¬Ø±Ø§Ø¡ ØªÙˆÙÙŠØ± Ù„ÙˆØ§Ø²Ù… ØªÙ‚Ù†ÙŠØ©</h5> 
      <h4 style="margin:5px 0; font-weight:600;">Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© (Ù…ÙˆØ­Ø¯)</h4> 
    </div>

   <!-- Ù†Ù…ÙˆØ°Ø¬ Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨ (Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰) -->

   

<form id="requestForm" onsubmit="event.preventDefault(); submitRequestForm();">
  
  <div class="section-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ù‚Ø¯Ù… Ø·Ù„Ø¨ Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
  
  <label>Ø§Ø³Ù… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</label>
  <input type="text" id="applicantName">

  <label>Ø§Ù„Ù‚Ø³Ù…</label>
  <input type="text" id="department">

  <label>ØªØ§Ø±ÙŠØ® ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨</label>
  <input type="date" id="requestDate">

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
  <input type="text" id="deviceType">

  <div class="section-title">ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„ Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</div>
  <div class="radio-group">
    <label>
      <input type="radio" name="faultType" value="Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…Ù„Ø­Ù‚Ø©" required>
      Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…Ù„Ø­Ù‚Ø©
    </label>
    <label><input type="radio" name="faultType" value="Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø²"> Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
    <label><input type="radio" name="faultType" value="Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©"> Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©</label>
    <label><input type="radio" name="faultType" value="Ø£Ø®Ø±Ù‰"> Ø£Ø®Ø±Ù‰</label>
  </div>

  <div class="section-title">ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ÙÙ†ÙŠØ© Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</div>
  <label>ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ÙÙ†ÙŠØ© Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</label>
  <textarea id="problemDescription" rows="4"></textarea>

  <!-- Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ³ØªÙ„Ù… Ø§Ù„Ø·Ù„Ø¨ -->
  <div class="section-title">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
  <label>Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</label>
  <select id="headTech">
    <option value="ibtisam.alkalbani@cpa.gov.om">Ø§Ø¨ØªØ³Ø§Ù… Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ</option>
    <!-- Ù„Ùˆ Ø¹Ù†Ø¯Ùƒ Ø£ÙƒØ«Ø± Ù…Ù† Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… ØªØ¶ÙŠÙÙŠÙ‡Ù… Ù‡Ù†Ø§ -->
  </select>

  <button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</button>
  </form>
<div class="success-message" id="successMessageRequest">
  ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø¨Ù†Ø¬Ø§Ø­!
</div>

 <!-- Ø¹Ù†ÙˆØ§Ù† Ø®Ø§Øµ Ø¨Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
<div class="section-title it-section">Ø®Ø§Øµ Ø¨Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div>

<!-- 2ï¸âƒ£ Ù†Ù…ÙˆØ°Ø¬ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ (Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…) -->
<form id="assignForm" onsubmit="event.preventDefault(); assignToTech();">

  <div class="section-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ</label>
  <select id="staffEmailTech">
    <option value="noura.alhanai@cpa.gov.om">Ù†ÙˆØ±Ø© Ø§Ù„Ù‡Ù†Ø§Ø¦ÙŠ</option>
    <option value="Ruqaia.5010@cpa.gov.om">Ø±Ù‚ÙŠØ© Ø§Ù„Ù…Ù‚Ø¨Ø§Ù„ÙŠ</option>
    <option value="Khadija.5011@cpa.gov.om">Ø®Ø¯ÙŠØ¬Ø© Ø§Ù„Ø´ÙƒÙŠÙ„ÙŠ</option>
    <option value="ibtisam.alkalbani@cpa.gov.om">Ø§Ø¨ØªØ³Ø§Ù… Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ</option>
    <option value="Iman.2271@cpa.gov.om">Ø¥ÙŠÙ…Ø§Ù† Ø§Ù„ØºØ§ÙØ±ÙŠ</option>
  </select>

  <button type="submit">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨</button>

  <div class="success-message" id="successMessageAssign">
    ØªÙ… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ù…ÙˆØ¸Ù Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø¨Ù†Ø¬Ø§Ø­.
  </div>

</form>

<!-- 3ï¸âƒ£ Ù†Ù…ÙˆØ°Ø¬ Ù…ÙˆØ¸Ù Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ (Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ + Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…) -->
<form id="techForm" onsubmit="event.preventDefault(); submitTechForm();">
  <input type="hidden" id="editRow">

  <div class="section-title">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ Ù…Ù† Ù…ÙˆØ¸Ù Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>

  <label>Ù‡Ù„ ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ</label>
  <select id="solutionResolved">
    <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
    <option value="Ù„Ø§">Ù„Ø§</option>
  </select>

  <label>ØªØ§Ø±ÙŠØ® Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</label>
  <input type="date" id="solutionDate">

  <label>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª</label>
  <textarea id="actionsRecommendations" rows="4"></textarea>

  <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)</label>
  <input type="text" id="techName" placeholder="Ø§Ù„Ø§Ø³Ù…">

  <div class="section-title">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…</div>
  <label>Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)</label>
  <select id="headReport">
    <option value="ibtisam.alkalbani@cpa.gov.om">Ø§Ø¨ØªØ³Ø§Ù… Ø§Ù„ÙƒÙ„Ø¨Ø§Ù†ÙŠ</option>
  </select>

  <div class="section-title">Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
  <label>Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…</label>
  <textarea id="headOpinion" rows="4" placeholder="Ø§ÙƒØªØ¨ Ø±Ø£ÙŠÙƒ Ù‡Ù†Ø§..."></textarea>

  <button type="submit">Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ</button>

  <div class="success-message" id="successMessageTech">
    ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ ÙˆØ±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­!
  </div>

</form>

<div style="text-align: center;">
  <a href="login.html" class="back-link">
    <i class="fas fa-arrow-right"></i> Ø§Ù„Ø±Ø¬ÙˆØ¹
  </a>
</div>


  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
  <div class="form-meta">
    <div>Ø§Ù„Ø±Ù…Ø²: <strong>SOP-079-03</strong></div>
    <div>Ø§Ù„Ø¥ØµØ¯Ø§Ø±: <strong>02</strong> | Ø§Ù„ØªØ§Ø±ÙŠØ®: <strong>ÙŠÙˆÙ„ÙŠÙˆ 2024</strong></div>
  </div>


  <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
  <div class="success-message" id="successMessageTech">
    ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ ÙˆØ±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­!
  </div>




  
 <script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbzlBzxsDJ4F8vRqaSX8_SRaf1Lt9dh5ecd24-EwUUIZZvJvWVEm7Hb9rCxM5M98E4m_2A/exec';

/* Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø©: Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ø«Ù… Ø¥Ø®ÙØ§Ø¤Ù‡Ø§ */
function showSuccess(id) {
  const box = document.getElementById(id);
  if (!box) return;
  box.style.display = "block";
  setTimeout(() => { box.style.display = "none"; }, 2500);
}

/* 1ï¸âƒ£ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ (Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨) */
function submitRequestForm() {
  const fault = document.querySelector('input[name="faultType"]:checked');

  const headSel = document.getElementById('headTech');   // Ø±Ø¦ÙŠØ³ Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ
  const headEmail = headSel ? headSel.value : "";
  const headName  = headSel && headSel.options[headSel.selectedIndex] 
                    ? headSel.options[headSel.selectedIndex].text.trim()
                    : "";

  const data = {
    action: "create",

    "Ø§Ø³Ù… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨": document.getElementById('applicantName').value.trim(),
    "Ø§Ù„Ù‚Ø³Ù…": document.getElementById('department').value.trim(),
    "ØªØ§Ø±ÙŠØ® ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨": document.getElementById('requestDate').value,
    "Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²": document.getElementById('deviceType').value.trim(),

    "ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„ Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨": fault ? fault.value : "",
    "ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ÙÙ†ÙŠØ© Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨": document.getElementById('problemDescription').value.trim(),

    "Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…": headName,
    "Ø¨Ø±ÙŠØ¯ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…": headEmail,

    "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ": "",
    "Ù‡Ù„ ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ": "",
    "ØªØ§Ø±ÙŠØ® Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©": "",
    "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª": "",
    "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)": "",
    "Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)": "",
    "Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…": ""
  };

  console.log("Request data:", data);

  fetch(scriptURL, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify(data)
  })
  .then(() => {
    document.getElementById('applicantName').value = '';
    document.getElementById('department').value = '';
    document.getElementById('requestDate').value = '';
    document.getElementById('deviceType').value = '';
    document.getElementById('problemDescription').value = '';

    document.querySelectorAll('input[name="faultType"]').forEach(r => r.checked = false);
    if (headSel) headSel.selectedIndex = 0;

    document.getElementById('applicantName').focus();

    showSuccess('successMessageRequest');
    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");
  })
  .catch(err => {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨:', err);
    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
  });
}


function assignToTech() {
  const techSel   = document.getElementById('staffEmailTech');
  const techEmail = techSel ? techSel.value : "";
  const techName  = techSel && techSel.options[techSel.selectedIndex]
                    ? techSel.options[techSel.selectedIndex].text.trim()
                    : "";

  if (!techEmail) {
    alert("Ø±Ø¬Ø§Ø¡Ù‹ Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ Ø£ÙˆÙ„Ø§Ù‹.");
    return;
  }

  const data = {
    action: "assignTech",
    "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ": techName,
    "Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ": techEmail
  };

  console.log("Assign data:", data);

  fetch(scriptURL, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify(data)
  })
  .then(() => {
    if (techSel) techSel.selectedIndex = 0;
    showSuccess('successMessageAssign');
    alert("ØªÙ… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ù…ÙˆØ¸Ù Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø¨Ù†Ø¬Ø§Ø­.");
  })
  .catch(err => {
    console.error('Ø®Ø·Ø£ ÙÙŠ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨:', err);
    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
  });
}


/* 3ï¸âƒ£ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ ÙˆØ±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… (Ù…ÙˆØ¸Ù Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ + Ø§Ù„Ø±Ø¦ÙŠØ³) */
function submitTechForm() {

  const headRepSel   = document.getElementById('headReport');
  const headRepEmail = headRepSel ? headRepSel.value : "";
  const headRepName  = headRepSel && headRepSel.options[headRepSel.selectedIndex]
                       ? headRepSel.options[headRepSel.selectedIndex].text.trim()
                       : "";

  const solutionValue = document.getElementById('solutionResolved').value;
  const dateValue     = document.getElementById('solutionDate').value;
  const actionsValue  = document.getElementById('actionsRecommendations').value;

  // ğŸ‘ˆ Ù„Ùˆ Ø¬Ø§ÙŠÙŠÙ† Ù…Ù† "ØªØ¹Ø¯ÙŠÙ„" Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨ÙŠÙƒÙˆÙ† ÙÙŠÙ‡ Ø±Ù‚Ù… ØµÙ Ù‡Ù†Ø§
  const editRowInput = document.getElementById('editRow');
  const editRow = editRowInput ? editRowInput.value.trim() : "";

  const data = {
    action: "updateTech",

    // Ù„Ùˆ ÙÙŠÙ‡ Ø±Ù‚Ù… ØµÙ Ù†Ø±Ø³Ù„Ù‡ Ù„Ù„Ø³ÙƒØ±Ø¨ØªØŒ Ù„Ùˆ ÙØ§Ø¶ÙŠ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙŠØ±Ø¬Ø¹ Ù„Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚Ø¯ÙŠÙ…
    row: editRow,

    "Ù‡Ù„ ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ": solutionValue,
    "ØªØ§Ø±ÙŠØ® Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©": dateValue || "",
    "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª": actionsValue.trim(),
    "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)": document.getElementById('techName').value.trim(),
    "Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)": headRepName,
    "Ø¨Ø±ÙŠØ¯ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)": headRepEmail,
    "Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…": document.getElementById('headOpinion').value.trim()
  };

  console.log("Tech report data:", data);

  fetch(scriptURL, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify(data)
  })
  .then(() => {
    // ğŸ”„ ØªÙØ±ÙŠØº Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ
    document.getElementById('solutionResolved').selectedIndex = 0;
    document.getElementById('solutionDate').value = '';
    document.getElementById('actionsRecommendations').value = '';
    document.getElementById('techName').value = '';
    if (headRepSel) headRepSel.selectedIndex = 0;
    document.getElementById('headOpinion').value = '';

    // Ù†Ø®Ø±Ø¬ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸
    if (editRowInput) editRowInput.value = "";

    showSuccess('successMessageTech');
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ ÙˆØ±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­!");
    // Ù†Ø­Ø¯Ù‘Ø« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø´Ø§Ù† ØªØ´ÙˆÙÙŠ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¨Ø§Ø´Ø±Ø©
    if (typeof loadReports === "function") {
      loadReports();
    }
  })
  .catch(err => {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ:', err);
    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
  });
}

function startEdit(row) {
  const rowNum = Number(row);
  if (!rowNum) return;

  fetch(scriptURL + '?action=getReports&t=' + Date.now())
    .then(res => res.json())
    .then(rows => {
      const record = rows.find(r => r.row === rowNum);
      if (!record) {
        alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„");
        return;
      }

      // Ø¯Ø§Ù„Ø© Ø¢Ù…Ù†Ø© Ù„Ø¶Ø¨Ø· Ø§Ù„Ù‚ÙŠÙ…Ø©
      function safeSet(id, value) {
        const el = document.getElementById(id);
        if (el) el.value = value || "";
      }

      // Ù†Ø®Ø²Ù† Ø±Ù‚Ù… Ø§Ù„ØµÙ ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ù…Ø®ÙÙŠ (Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙØ±Ø³Ù„ Ù…Ø¹ submitTechForm)
      safeSet("editRow", rowNum);

      // ğŸ”¹ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨
      safeSet('applicantName',      record["Ø§Ø³Ù… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨"]);
      safeSet('department',         record["Ø§Ù„Ù‚Ø³Ù…"]);
      safeSet('requestDate',        record["ØªØ§Ø±ÙŠØ® ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨"]);
      safeSet('deviceType',         record["Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²"]);
      safeSet('problemDescription', record["ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ÙÙ†ÙŠØ© Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨"]);

      // ğŸ”¹ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ
      safeSet('solutionResolved',       record["Ù‡Ù„ ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ"] || "Ù„Ø§");
      safeSet('solutionDate',           record["ØªØ§Ø±ÙŠØ® Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©"]);
      safeSet('actionsRecommendations', record["Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª"]);
      safeSet('techName',               record["Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø®ØªØµ (Ø§Ù„ØªÙ‚Ø±ÙŠØ±)"]);
      safeSet('headOpinion',            record["Ø±Ø£ÙŠ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…"]);

      // ğŸ”¹ ØªØ¹Ø¨Ø¦Ø© Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯)
      const faultValue = record["ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„ Ù…Ù† Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨"] || "";
      if (faultValue) {
        const faultRadio = document.querySelector(`input[name="faultType"][value="${faultValue}"]`);
        if (faultRadio) faultRadio.checked = true;
      }

      // Ù†Ù‚Ø¯Ø± Ù†Ø³ÙƒØ±ÙˆÙ„ Ù„Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ÙÙ†ÙŠ Ù„Ùˆ Ø­Ø§Ø¨
      const techFormEl = document.getElementById('techForm');
      if (techFormEl) {
        techFormEl.scrollIntoView({ behavior: 'smooth' });
      }
    })
    .catch(err => {
      console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù„Ù„ØªØ¹Ø¯ÙŠÙ„:", err);
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„.");
    });
}

document.addEventListener('DOMContentLoaded', () => {
  // Ù†Ù‚Ø±Ø£ Ø±Ù‚Ù… Ø§Ù„ØµÙ Ø§Ù„Ù…Ø®Ø²Ù† Ù…Ù† report1.html
  const row = localStorage.getItem('editRow');
  if (row) {
    // Ù†Ø´ØºÙ‘Ù„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    startEdit(row);
    // Ù†ÙØ¶ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØ¹ÙŠØ¯ ÙØªØ­ Ù†ÙØ³ Ø§Ù„ØµÙ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©
    localStorage.removeItem('editRow');
  }
});

// (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) Ù…Ù†Ø¹ ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† + Ø§Ø®ØªØµØ§Ø±Ø§Øª
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('keydown', function (e) {
    if (e.key === 'F12') e.preventDefault();
    if (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key.toUpperCase())) e.preventDefault();
    if (e.ctrlKey && e.key.toUpperCase() === 'U') e.preventDefault();
  });
 
</script>


</body>
</html>